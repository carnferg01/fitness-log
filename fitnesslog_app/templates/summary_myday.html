{% extends "base.html" %}

{% block title %}My day{% endblock %}

{% block content %}

<style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    .form-group { margin-bottom: 1em; }
</style>

<style>
        .activity {
            margin-bottom: 20px; /* space between each activity */
        }
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .row .left {
            display: flex;
            align-items: center;
        }
        .square {
            width: 16px;
            height: 16px;
            background-color: #4CAF50; /* change color as needed */
            margin-right: 10px;
        }
        .indent {
            padding-left: 2em; /* tab-like indent */
        }

        /* Separator styles */
        .separator-container {
            display: flex;
            align-items: center;
            margin: 30px 0;
            width: 100%;
        }
        .separator-line {
            flex-grow: 1;
            height: 2px;
            background-color: #ccc;
        }
        .separator-label {
            padding: 0 10px;
            white-space: nowrap;
            font-size: 0.9em;
            color: #666;
        }
    </style>

/<!-- Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>All Activities</h1>
    <div>
        <a href="{% url 'activity_add' %}" class="btn btn-primary">Add Activity</a>
    </div>
</div>

<!-- Date selector -->
<form id="date-form" method="post">
    {% csrf_token %}
    <div class="form-group">
        {{ form.date.label_tag }}
        {{ form.date }}
    </div>
</form>

<!-- Totals -->
 {% if day_stats %}
    <h2>Results:</h2>
    <p>{{ data.message }}</p>
    <p>{{ data.extra }}</p>
{% endif %}


<!-- Activities -->
{% for activity in day_activities %}
    {% if item.gap_hours %}
        <div class="separator-container">
            <div class="separator-line"></div>
            <div class="separator-label">{{ item.gap_hours }} hour{{ item.gap_hours|pluralize }}</div>
            <div class="separator-line"></div>
        </div>
    {% endif %}

    <div class="activity">
        <!-- Row 1 -->
        <div class="row">
            <div class="left">
                <div class="square"></div>
                <div>{{ activity.sport }}</div>
                <div style="margin-left: 10px;">{{ activity.load }}</div>
            </div>
            <div>{{ activity.start_datetime }}</div>
        </div>

        <!-- Row 2 -->
        <div class="indent">{{ activity.time_elapsed }}</div>

        <!-- Row 3 -->
        <div class="indent">{{ activity.total_distance }} km + {{ activity.total_climb }} m</div>
    </div>
{% endfor %}



<script>
    document.addEventListener("DOMContentLoaded", function () {
        const dateInput = document.querySelector("input[type='date']");
        const form = document.getElementById("date-form");

        if (!dateInput.value) {
            const today = new Date().toISOString().split('T')[0];
            dateInput.value = today;
            form.submit();  // submit once with today's date
        }

        dateInput.addEventListener("change", function () {
            form.submit();  // also submit on manual change
        });
    });
</script>

{% endblock %}