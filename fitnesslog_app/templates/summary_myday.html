{% extends "base.html" %}

{% block title %}My day{% endblock %}

{% block content %}

<style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    .form-group { margin-bottom: 1em; }
</style>

<form id="date-form" method="get">
    <div class="form-group">
        {{ form.date.label_tag }}
        {{ form.date }}
    </div>
</form>

{% if data %}
    <h2>Results:</h2>
    <p>{{ data.message }}</p>
    <p>{{ data.extra }}</p>
{% endif %}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const dateInput = document.querySelector("input[type='date']");
        const form = document.getElementById("date-form");

        // If no date was pre-filled from the server, set today
        if (!dateInput.value) {
            const today = new Date().toISOString().split('T')[0];
            dateInput.value = today;
            form.submit();  // submit form immediately with today's date
        }

        // Submit when user changes date manually
        dateInput.addEventListener("change", function () {
            form.submit();
        });
    });
</script>

{% endblock %}